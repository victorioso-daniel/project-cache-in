erDiagram
    %% =========================
    %% AUTHENTICATION & ROLES
    %% =========================
    USER ||--o{ USER_ROLE : has
    ROLE ||--o{ USER_ROLE : assigned
    ROLE ||--o{ ROLE_PERMISSION : grants
    PERMISSION ||--o{ ROLE_PERMISSION : belongs

    %% =========================
    %% QUIZ EVENTS
    %% =========================
    USER ||--o{ QUIZ_EVENT : creates
    QUIZ_EVENT ||--o{ TEAM : has
    QUIZ_EVENT ||--o{ QUESTION : contains
    QUIZ_EVENT ||--o{ EVENT_WINNER : results

    %% =========================
    %% TEAMS & PARTICIPANTS
    %% =========================
    TEAM ||--o{ SUBMISSION : submits
    TEAM ||--o{ EVENT_WINNER : ranks

    %% =========================
    %% QUESTIONS & ANSWERS
    %% =========================
    QUESTION ||--o{ QUESTION_CHOICE : choices
    QUESTION ||--o{ SUBMISSION : receives

    %% =========================
    %% TABLE DEFINITIONS
    %% =========================
    USER {
        bigint id PK
        varchar username
        varchar password_hash
        varchar display_name
    }

    ROLE {
        bigint id PK
        varchar name
    }

    PERMISSION {
        bigint id PK
        varchar name
    }

    USER_ROLE {
        bigint id PK
        bigint user_id FK
        bigint role_id FK
    }

    ROLE_PERMISSION {
        bigint id PK
        bigint role_id FK
        bigint permission_id FK
    }

    QUIZ_EVENT {
        bigint id PK
        varchar title
        boolean is_active
        timestamp created_at
        bigint created_by FK
    }

    TEAM {
        bigint id PK
        varchar name
        varchar access_code
        bigint quiz_event_id FK
    }

    QUESTION {
        bigint id PK
        bigint quiz_event_id FK
        text question_text
        varchar difficulty
        varchar correct_answer
        int points
    }

    QUESTION_CHOICE {
        bigint id PK
        bigint question_id FK
        varchar choice_text
        boolean is_correct
    }

    SUBMISSION {
        bigint id PK
        bigint team_id FK
        bigint question_id FK
        varchar answer_text
        boolean is_correct
        int points_earned
        timestamp submitted_at
    }

    EVENT_WINNER {
        bigint id PK
        bigint team_id FK
        bigint quiz_event_id FK
        int rank
        int total_score
    }
